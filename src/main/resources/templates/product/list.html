<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{index :: dynamic(~{::main})}">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
    <main class="mb-2">
        <div class="mb-4">
            <!-- Sort Dropdown -->
            <div class="row justify-content-end">
                <div class="btn-group shadow-0 mb-2 col-md-3">
                    <button type="button" class="btn btn-light dropdown-toggle" data-mdb-toggle="dropdown" aria-expanded="false">
                        Sắp xếp
                    </button>
                    <ul class="dropdown-menu dropdown-menu-lg-end">
                        <li ng-repeat="s in sortUI">
                            <a class="dropdown-item" href="" ng-click="sortProducts(s.code)">{{s.name}}</a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- End Sort Dropdown -->

            <!-- loading spinner START-->
            <div class="row justify-content-center my-4" ng-show="loading">
                <div class="spinner-border" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
            </div>
            <!-- loading spinner END-->

            <!-- product list -->
            <div class="row row-cols-1 row-cols-md-4 g-4 mb-4" style="min-height: 50vh;">
                <div class="col-md-3 col-lg-3 col-sm-12"
                    ng-repeat="p in pager.productList | filter : {color: selectedColor} | rangeFilter:'price':0:priceRange">

                    <!-- product card START-->
                    <div class="card">
                        <a href="{{'/product/detail/' + p.id}}">
                            <img ng-src="{{'/assets/images/'+ p.image}}" class="card-img-top" alt="Product image" />
                        </a>

                        <div ng-show="p.sale_off != 0" class="label-top bg-danger shadow-sm">
                            <a class="text-white" href="#">Sale: {{p.sale_off | number: 0}}%</a>
                        </div>

                        <div class="card-body">
                            <h5 class="card-title">{{p.name}}</h5>
                            <p>{{p.color}}</p>
                            <p class="card-text d-flex justify-content-between">
                                <span><sup>đ</sup> {{p.price | number:0}}</span>
                                <span style="color: grey;">Đã bán {{p.sold}}</span>
                            </p>
                            <div class="d-grid gap-2">
                                <button type="button" class="btn btn-outline-secondary" data-mdb-ripple-color="dark" ng-click="cart.add(p.id)">
                                    Thêm vào giỏ
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- product card END-->
                </div>
            </div>
            <!-- end product list -->

            <!-- paging - START -->
            <div class="d-flex justify-content-center">
                <nav aria-label="Page navigation example">
                    <div class="justify-content-center btn-group btn-group-xs">
                        <button class="btn btn-secondary btn-sm" ng-click="pager.first()"> &lArr;</button>
                        <button class="btn btn-secondary btn-sm" ng-click="pager.prev()">&larr; </button>
                        <button class="btn btn-secondary btn-sm">{{pager.page+1}} - {{pager.count}}</button>
                        <button class="btn btn-secondary btn-sm" ng-click="pager.next()"> &rarr; </button>
                        <button class="btn btn-secondary btn-sm" ng-click="pager.last()">&rArr; </button>
                    </div>
                </nav>
            </div>
            <!-- paging - END -->
        </div>

        <script th:inline="javascript">
            let message = /*[[${ message }]]*/ null;
            let isPaymentSuccess = /*[[${ isPaymentSuccess }]]*/ false;
            if (isPaymentSuccess) {
                localStorage.removeItem('cart');
            }
            if (message != null) {
                alert(message);
            }
        </script>
    </main>
</body>

</html>